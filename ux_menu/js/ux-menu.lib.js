!function(e,t,n){"use strict";function i(t,n){this.element=t,this._name=r,this._defaults=e.fn.uxMenu.defaults,this.options=e.extend({},this._defaults,n),this.animationEvent=a(),this.init()}function a(){var e,t=n.createElement("fakeelement"),i={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(e in i)if("undefined"!==t.style[e])return i[e]}var r="uxMenu";e.extend(i.prototype,{init:function(){this.buildCache(),this.buildElement(),this.bindEvents()},destroy:function(){this.unbindEvents(),this.$element.removeData()},buildCache:function(){this.$element=e(this.element),this.$menu=this.$element.find("."+r+"-menu"),this.$wrap=this.$menu.find("."+r+"-wrap"),this.$menus=this.$menu.find("."+r+"-level"),this.menusArr=[],this.breadCrumbs=!1,(this.options.breadcrumbNav||this.options.backNav)&&(this.$breadcrumbWrapper=this.$element.find("."+r+"-top")),this.options.backNav&&(this.$backWrapper=this.$element.find("."+r+"-top"));var t=0;this.$menus.each(function(n){e(this).find("."+r+"-link.is-active").length&&(t=n)}),this.current_menu=t},buildElement:function(){var t=this,n=[],i=null;if(this.$menus.each(function(i){var a=e(this),s={$menuEl:a,$menuItems:a.find("."+r+"-item")};t.menusArr.push(s),i===t.current_menu&&(a.addClass(r+"-level--current"),t.setWrapHeight(a)),a.find("."+r+"-link[data-submenu]").each(function(){var a=e(this);t.options.itemIcon&&a.append(t.options.itemIcon);var r=a.attr("data-submenu"),s={menu:r,name:a.html()};n[i]?n[i].push(s):(n[i]=[],n[i].push(s))})}),this.$menus.each(function(i){var a=e(this),r=a.attr("data-menu");n.forEach(function(e,n){e.forEach(function(e,a){e.menu===r&&(t.menusArr[i].backIdx=n,t.menusArr[i].name=e.name)})})}),t.options.backNav&&(i=t.fetchSelector(t.options.backSelector))){i.empty(),t.$backNav=e('<a class="'+r+'-back" aria-label="'+t.options.backText+'" href="#"></a>').prependTo(i);var a=t.options.backText;t.options.backIcon&&(a=t.options.backIcon+" "+a),t.$backNav.html(a)}t.options.breadcrumbNav&&(i=t.fetchSelector(t.options.breadcrumbSelector),i&&(i.empty(),t.$breadcrumbNav=e('<nav class="'+r+'-breadcrumbs" aria-label="You are here"></nav>').prependTo(i),t.addBreadcrumb(0),0!==t.menusArr[t.current_menu].backIdx&&0!==t.current_menu&&(t.crawlCrumbs(t.menusArr[t.current_menu].backIdx,t.menusArr),t.breadCrumbs=!0),0!==t.current_menu&&(t.addBreadcrumb(t.current_menu),t.breadCrumbs=!0)))},fetchSelector:function(t){var n=this.$element.find(t);return n.length||(n=e(t).first()),n.length?n:null},bindEvents:function(){for(var t=this,n=0,i=this.menusArr.length;n<i;++n)this.menusArr[n].$menuItems.each(function(n){e(this).find("."+r+"-link[data-submenu]").on("click",function(i){var a=e(this),s=a.html(),o=a.attr("data-submenu"),u=t.$menu.find("."+r+'-level[data-menu="'+o+'"]');u.length?(i.preventDefault(),t.openSubMenu(u,n,s)):(t.$menu.find("."+r+"-link--current").removeClass(r+"-link--current"),a.addClass(r+"-link--current"))})});this.options.backNav&&this.$backNav.on("click",function(e){t.back()})},addBreadcrumb:function(t){if(!this.options.breadcrumbNav)return!1;var n=this,i=t?this.menusArr[t].name:this.options.breadcrumbText;i=i.replace(/<([^>]+?)([^>]*?)>(.*?)<\/\1>/gi,"");var a=e('<span class="uxMenu-breadcrumb">');t&&n.options.breadcrumbIcon&&a.html(n.options.breadcrumbIcon);var r=e('<a href="#"></a>').html(i).appendTo(a);r.on("click",function(e){if(e.preventDefault(),!a.next().length||n.isAnimating)return!1;n.isAnimating=!0,n.menuOut();var i=n.menusArr[t].$menuEl;n.menuIn(i);var r=a.nextAll();r.one(n.animationEvent,function(e){r.remove()}).addClass("animate-fadeOut")}),this.$breadcrumbNav.append(a),a.addClass("animate-fadeIn")},crawlCrumbs:function(e,t){this.log("Crawl Crumbs"),0!==t[e].backIdx&&this.crawlCrumbs(t[e].backIdx,t),this.addBreadcrumb(e)},openSubMenu:function(e,t,n){if(this.isAnimating)return!1;var i=this.$menus.index(e);this.isAnimating=!0,this.menusArr[i].backIdx=this.current_menu,this.menusArr[i].name=n,this.menuOut(t),this.menuIn(e,t)},back:function(){if(this.isAnimating)return!1;this.isAnimating=!0,this.menuOut();var e=this.menusArr[this.menusArr[this.current_menu].backIdx].$menuEl;this.menuIn(e),this.options.breadcrumbNav&&this.$breadcrumbNav.children().last().remove()},menuOut:function(e){var t=this,n=this.menusArr[this.current_menu].$menuEl,i="undefined"==typeof e;this.menusArr[this.current_menu].$menuItems.each(function(n){this.style.WebkitAnimationDelay=this.style.animationDelay=i?parseInt(n*t.options.itemDelayInterval)+"ms":parseInt(Math.abs(e-n)*t.options.itemDelayInterval)+"ms"}),"r2l"===this.options.direction?n.addClass(i?"animate-outToRight":"animate-outToLeft"):n.addClass(i?"animate-outToLeft":"animate-outToRight")},setWrapHeight:function(t){var n=this;t=t||this.$menus.filter("."+r+"-level--current");var i=this.$wrap.height(),a=0;t.children().each(function(){a+=e(this).outerHeight()}),n.$element.offsetParent().animate({scrollTop:0},1e3),i<=a?this.$wrap.height(a):t.one(this.animationEvent,function(e){n.$wrap.height(a)})},menuIn:function(t,n){var i=this,a=this.menusArr[this.current_menu].$menuEl,s="undefined"==typeof n,o=this.$menus.index(t),u=this.menusArr[o],m=u.$menuItems,c=m.length;i.setWrapHeight(t),s?0===o&&i.options.backNav&&i.$backNav.removeClass("animate-fadeIn").addClass("animate-fadeOut"):(i.options.backNav&&i.$backNav.removeClass("animate-fadeOut").addClass("animate-fadeIn"),i.addBreadcrumb(o)),m.each(function(u){this.style.WebkitAnimationDelay=this.style.animationDelay=s?parseInt(u*i.options.itemDelayInterval)+"ms":parseInt(Math.abs(n-u)*i.options.itemDelayInterval)+"ms";var m=n<=c/2||s?c-1:0;u===m&&e(this).one(i.animationEvent,function(e){"r2l"===i.options.direction?(a.removeClass(s?"animate-outToRight":"animate-outToLeft"),t.removeClass(s?"animate-inFromLeft":"animate-inFromRight")):(a.removeClass(s?"animate-outToLeft":"animate-outToRight"),t.removeClass(s?"animate-inFromRight":"animate-inFromLeft")),a.removeClass(r+"-level--current"),t.addClass(r+"-level--current"),i.current_menu=o,i.isAnimating=!1,t.focus()})}),"r2l"===this.options.direction?t.addClass(s?"animate-inFromLeft":"animate-inFromRight"):t.addClass(s?"animate-inFromRight":"animate-inFromLeft")},unbindEvents:function(){this.$element.off("."+this._name)},log:function(e){this.options.debug&&("object"==typeof e?console.log("["+this._name+"]",e):console.log("["+this._name+"] "+e))},error:function(e){"object"==typeof e?console.error("["+this._name+"]",e):console.error("["+this._name+"] "+e)}}),e.fn.uxMenu=function(t){var n=arguments;if("undefined"===t||"object"==typeof t)return this.each(function(){e.data(this,r)||e.data(this,r,new i(this,t))});if("string"==typeof t&&"_"!==t[0]&&"init"!==t){var a;return this.each(function(){var s=e.data(this,r);s instanceof i&&"function"==typeof s[t]&&(a=s[t].apply(s,Array.prototype.slice.call(n,1))),"destroy"===t&&e.data(this,"plugin_"+r,null)}),"undefined"!==a?a:this}},e.fn.uxMenu.defaults={debug:!1,backNav:!1,backText:"Back",backIcon:"",breadcrumbNav:!0,backSelector:"."+r+"-top",breadcrumbText:"All",breadcrumbIcon:"",breadcrumbSelector:"."+r+"-top",itemIcon:"",itemDelayInterval:60,direction:"r2l",theme:"",relocateNav:"",onItemClick:null}}(jQuery,window,document);